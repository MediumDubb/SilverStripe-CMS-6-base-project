!function(){"use strict";var t={40:function(t){t.exports=ReactRedux},127:function(t){t.exports=InsertLinkModal},145:function(t){t.exports=ReactDomClient},207:function(t){t.exports=Injector},502:function(t){t.exports=ShortcodeSerialiser},594:function(t){t.exports=React},669:function(t){t.exports=jQuery},671:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;const n=(t,e)=>t?`${t}.${e}`:e;window.ss=window.ss||{},window.ss.tinymceactions=window.ss.tinymceactions||new class{constructor(){this.actions={},this.editorCommandsToUrlTestsMap={},this.defaultCommand="sslinkexternal"}addAction(t,e,i){const o=e.priority||50,r=n(i,t),s=this.getActions(t,i,!0);return e.type="menuitem",e.hasOwnProperty("onclick")&&(e.onAction=e.onclick,delete e.onclick),s.find(t=>e.text===t.text)||(this.actions[r]=[...this.getActions(t,i,!1),{...e,priority:o}]),this}getActions(t,e,i=!0){let o=e&&!i||!this.actions[t]?[]:this.actions[t];const r=n(e,t);return e&&this.actions[r]&&(o=[...o,...this.actions[r]]),o}getSortedActions(t,e,n=!0){return this.getActions(t,e,n).sort((t,e)=>{const n=e.priority-t.priority;return n||(t.text.toLocaleLowerCase()>e.text.toLocaleLowerCase()?1:-1)})}addCommandWithUrlTest(t,e){return this.editorCommandsToUrlTestsMap[t]=e,this}setDefaultCommand(t){return this.defaultCommand=t,this}getDefaultCommand(){return this.defaultCommand}getEditorCommandFromUrl(t){let e=this.getDefaultCommand();const n=Object.keys(this.editorCommandsToUrlTestsMap).find(e=>this.editorCommandsToUrlTestsMap[e]&&this.editorCommandsToUrlTestsMap[e].test(t));return n&&(e=n),e}};e.default=window.ss.tinymceactions},815:function(t){t.exports=i18n},918:function(t){t.exports=AnchorSelectorActions}},e={};function n(i){var o=e[i];if(void 0!==o)return o.exports;var r=e[i]={exports:{}};return t[i](r,r.exports,n),r.exports}!function(){var t=u(n(815)),e=u(n(671)),i=u(n(594)),o=n(145),r=n(40),s=u(n(669)),a=u(n(502)),d=n(127),l=n(207),c=n(918);function u(t){return t&&t.__esModule?t:{default:t}}const m="sslinkanchor",h={init(n){e.default.addAction("sslink",{text:t.default._t("TinyMCE.LINKLABEL_ANCHOR","Anchor on a page"),onAction:t=>t.execCommand(m),priority:60},n.getParam("editorIdentifier")).addCommandWithUrlTest(m,/^\[sitetree_link.+]#[^#\]]+$/),n.addCommand(m,()=>{const t=(0,s.default)(`#${n.id}`).entwine("ss"),e=Number((0,s.default)("#Form_EditForm_ID").val()||0),i=(0,s.default)(n.getBody()).find("[id],[name]").toArray().map(t=>t.id||t.name);ss.store.dispatch((0,c.updatedCurrentField)(e,i,n.id)),t.openLinkAnchorDialog()})}},p="insert-link__dialog-wrapper--anchor",f=(0,l.provideInjector)((0,d.createInsertLinkModal)("SilverStripe\\Admin\\LeftAndMain","editorAnchorLink"));s.default.entwine("ss",e=>{e("textarea.htmleditor").entwine({openLinkAnchorDialog(){let t=e(`#${p}`);t.length||(t=e(`<div id="${p}" />`),e("body").append(t)),t.addClass("insert-link__dialog-wrapper"),t.setElement(this),t.open()}}),e(`#${p}`).entwine({ReactRoot:null,renderModal(n){const s=ss.store,a=this.getOriginalAttributes(),d=this.getRequireLinkText(),l=Number(e("#Form_EditForm_ID").val()||0);let c=this.getReactRoot();c||(c=(0,o.createRoot)(this[0]),this.setReactRoot(c)),c.render(i.default.createElement(r.Provider,{store:s},i.default.createElement(f,{isOpen:n,onInsert:(...t)=>this.handleInsert(...t),onClosed:()=>this.close(),title:t.default._t("TinyMCE.LINK_ANCHOR","Link to an anchor on a page"),bodyClassName:"modal__dialog",className:"insert-link__dialog-wrapper--anchor",fileAttributes:a,identifier:"Admin.InsertLinkAnchorModal",requireLinkText:d,currentPageID:l})))},buildAttributes(t){return{href:`${a.default.serialise({name:"sitetree_link",properties:{id:t.PageID}},!0)}${t.Anchor&&t.Anchor.length?`#${t.Anchor}`:""}`,target:t.TargetBlank?"_blank":"",title:t.Description}},getOriginalAttributes(){const t=this.getElement().getEditor(),n=e(t.getSelectedNode()),i=(n.attr("href")||"").split("#");if(!i[0])return{};const o=a.default.match("sitetree_link",!1,i[0]);return o?{PageID:o.properties.id?parseInt(o.properties.id,10):0,Anchor:i[1]||"",Description:n.attr("title"),TargetBlank:!!n.attr("target")}:{}}})}),tinymce.PluginManager.add(m,t=>h.init(t))}()}();